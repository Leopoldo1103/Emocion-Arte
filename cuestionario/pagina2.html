<HTML>
    <HEAD>
        <title>What a feeling</title>
        <link rel="stylesheet" type="text/css" href="cuestionario.css"></link>
        <script src="script.js"></script>
        <script src="resultados.js"></script>
        <meta charset="UTF-8">
    </HEAD>
    
    <BODY>
        <div class="form-container show">
            <table>
                <form id="emotion-form">
                    <tr>
                        <!---------------------------------- MIEDO ---------------------------------->
                        <!-- Pregunta 1 -->
                        <fieldset>
                            <legend>¿TE GUSTARÍA HUIR?</legend>
                            <INPUT TYPE="radio" ID="Pregunta1" NAME="emocion-miedo" VALUE="Si" data-emocion="miedo">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 2 -->
                        <fieldset>
                            <legend>¿QUERRÍAS EVITAR ALGO QUE TIENES QUE HACER O ALQUIEN QUE A QUIÉN  TIENES QUE VER?</legend>
                            <INPUT TYPE="radio" ID="Pregunta2" NAME="emocion-miedo" VALUE="Si" data-emocion="miedo">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 3 -->
                        <fieldset>
                            <legend>¿TE SIENTES PETRIFICAD@?</legend>
                            <INPUT TYPE="radio" ID="Pregunta3" NAME="emocion-miedo" VALUE="Si" data-emocion="miedo">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 4 -->
                        <fieldset>
                            <legend>TIENES MOLESTIAS EN EL
                                ESTÓMAGO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta4" NAME="emocion-miedo" VALUE="Si" data-emocion="miedo">Si</INPUT><br>
                        </fieldset>
                        <br>

                        <!---------------------------------- IRA ---------------------------------->
                        <!-- Pregunta 5 -->
                        <fieldset>
                            <legend>¿SIENTES LA NECESIDAD DE DEFENDERTE?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta5" NAME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 6 -->
                        <fieldset>
                            <legend>¿TE SIENTES AGRESIVO O MÁS "BORDE" DE LO HABITUAL?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta6" NAME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 7 -->
                        <fieldset>
                            <legend>¿QUERRÍAS TIRAR O ROMPER COSAS?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta7" NAME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 8 -->
                        <fieldset>
                            <legend>¿TIENES ACELERADO EL PULSO Y LA RESPIRACIÓN?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta8" NAME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 9 -->
                        <fieldset>
                            <legend>¿SIENTES QUE TU SANGRE SE CALIENTA?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta9" AME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 10 -->
                        <fieldset>
                            <legend>¿SIENTES QUE PIERDES EL CONTROL?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta10" NAME="emocion-ira" VALUE="Si" data-emocion="ira">Si</INPUT><br>

                        </fieldset>
                        <br>

                        <!---------------------------------- TRISTEZA ---------------------------------->
                        <!-- Pregunta 11 -->
                        <fieldset>
                            <legend>¿TIENES GANAS DE LLORAR?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta11" NAME="emocion-tristeza" VALUE="Si" data-emocion="tristeza">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 12 -->
                        <fieldset>
                            <legend>¿TE SIENTES ENLENTECIDO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta12" NAME="emocion-tristeza" VALUE="Si" data-emocion="tristeza">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 13 -->
                        <fieldset>
                            <legend>¿TE SIENTES APÁTICO, SIN GANAS DE NADA?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta13" NAME="emocion-tristeza" VALUE="Si" data-emocion="tristeza">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 14 -->
                        <fieldset>
                            <legend>¿NECESITAS UN ABRAZO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta14" NAME="emocion-tristeza" VALUE="Si" data-emocion="tristeza">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 15 -->
                        <fieldset>
                            <legend>¿TE DUELE EL PECHO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta15" NAME="emocion-tristeza" VALUE="Si" data-emocion="tristeza">Si</INPUT><br>

                        </fieldset>
                        <br>

                        <!---------------------------------- ALEGRIA ---------------------------------->
                        <!-- Pregunta 16 -->
                        <fieldset>
                            <legend>¿SIENTES GANAS DE CELEBRAR ALGO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta16" NAME="emocion-alegria" VALUE="Si" data-emocion="alegria">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 17 -->
                        <fieldset>
                            <legend>¿TE APETECE REIR?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta17" NAME="emocion-alegria" VALUE="Si" data-emocion="alegria">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 18 -->
                        <fieldset>
                            <legend>¿NO PUEDES EVITAR SONREIR?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta18" NAME="emocion-alegria" VALUE="Si" data-emocion="alegria">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 19 -->
                        <fieldset>
                            <legend>¿QUIERES DAR BESOS Y ABRAZOS?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta19" NAME="emocion-alegria" VALUE="Si" data-emocion="alegria">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 20 -->
                        <fieldset>
                            <legend>¿SIENTES COSQUILLAS EN EL ESTÓMAGO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta20" NAME="emocion-alegria" VALUE="Si" data-emocion="alegria">Si</INPUT><br>

                        </fieldset>
                        <br>

                        <!---------------------------------- SORPRESA ---------------------------------->
                        <!-- Pregunta 21 -->
                        <fieldset>
                            <legend>¿SIENTES QUE NECESITAS INVESTIGAR SOBRE ALGO QUE HAYA PASADO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta21" NAME="emocion-sorpresa" VALUE="Si" data-emocion="sopresa">Si</INPUT><br>

                        </fieldset>
                        <br>
                        <!-- Pregunta 22 -->
                        <fieldset>
                            <legend>¿TE HARÍA FALTA DESCUBRIR DETALLES Y DATOS SOBRE ALGÚN ACONTECIMIENTO RECIENTE QUE NO
                                ESPERABAS?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta22" NAME="emocion-sorpresa" VALUE="Si" data-emocion="sopresa">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 23 -->
                        <fieldset>
                            <legend>¿TE ESTÁ COSTANDO REACCIONAR PORQUE NO SABES BIEN QUÉ HA PASADO?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta23" NAME="emocion-sorpresa" VALUE="Si" data-emocion="sopresa">Si</INPUT><br>

                        </fieldset>
                        <br>

                        <!---------------------------------- ASCO ---------------------------------->
                        <!-- Pregunta 24 -->
                        <fieldset>
                            <legend>¿TE SIENTES SUCI@?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta24" NAME="emocion-asco" VALUE="Si" data-emocion="asco">Si</INPUT><br>
                        </fieldset>
                        <br>
                        <!-- Pregunta 25 -->
                        <fieldset>
                            <legend>¿NECESITAS LIMPIARTE O DESINFECTARTE?</legend>
                            <INPUT TYPE="radio"  ID="Pregunta25" NAME="emocion-asco" VALUE="Si" data-emocion="asco">Si</INPUT><br>
                        </fieldset>
                        <br>

                        <!---------------------------------- ESTADO DE BIENESTAR EMOCIONAL ---------------------------------->
                        <!-- Pregunta 26 -->
                        <fieldset>
                            <legend>¿TE SIENTES RELAJAD@</legend>
                            <INPUT TYPE="radio" ID="Pregunta26" NAME="emocion-neutro" VALUE="Si" data-emocion="neutro">Si</INPUT><br>
                        </fieldset>
                        <br>                        
                        <!-- BOTONES -->
                        <tr>
                            <td>
                                <INPUT TYPE="reset" NAME="Restablecer" VALUE="Restablecer"></INPUT>
                                <INPUT TYPE="button" VALUE="Enviar" id="submit-btn" ONCLICK="window.location.href='resultado.html'">
                                <INPUT TYPE="button" VALUE="Volver atras" ONCLICK="window.location.href='pagina1.html'">
                            </td>
                        </tr>
                    </tr>
            </table>
        </div>
        <p id="resultado"> </p>
    </BODY>
</HTML>



<!---------------------------------- Cosas NO RELACIONADAS con el codigo HTML (NO MOVER DE AQUI) ---------------------------------->

<!-- BOTON TOP -->
<button onclick="topFunction()" id="myBtn" title="Go to top">Volver arriba</button>
<script> /* Script relacionado con boton TOP */
    // Get the button
    let mybutton = document.getElementById("myBtn");
    
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};
    
    function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "block";
        } else {
        mybutton.style.display = "none";
        }
    }
    
    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }
</script>

<script>
// Función para obtener las emociones del localStorage
function obtenerEmociones() {
  return JSON.parse(localStorage.getItem('emociones')) || [];
}

// Función para obtener el estado emocional
function obtenerEstadoEmocional() {
  // Leer las categorías del localStorage
  const categorias = JSON.parse(localStorage.getItem('categorias'));

  // Contar las respuestas para cada categoría
  const respuestas = obtenerEmociones();
  const recuento = {};
  for (const respuesta of respuestas) {
    recuento[respuesta] = (recuento[respuesta] || 0) + 1;
  }

  // Si todas las respuestas son de la misma categoría, el estado emocional es simple
  if (Object.keys(recuento).length === 1) {
    return Object.keys(recuento)[0];
  }

  // Si hay más de una categoría con la mayor cantidad de respuestas, el estado emocional es complejo
  if (Object.keys(recuento).filter(categoria => recuento[categoria] === Math.max(...Object.values(recuento))).length > 1) {
    return 'complejo';
  }

  // Si no hay respuestas, el estado emocional es neutro
  if (repuestas.length === 0) {
    return 'neutro';
  }

  // En caso de empate, se considera el estado emocional como complejo
  return 'complejo';
}

// Función para mostrar el resultado
function mostrarResultado() {
  // Obtener las emociones del localStorage
  const emociones = obtenerEmociones();

  // Obtener el estado emocional
  const estadoEmocional = obtenerEstadoEmocional();

  // Mostrar el resultado
  const resultadoElement = document.getElementById('resultado');
  const mensajeEmociones = document.getElementById('mensaje-emociones');

  if (estadoEmocional === 'complejo') {
    mensajeEmociones.textContent = `Te sientes ${emociones.join(', ')}`;
    resultadoElement.textContent = 'Estado emocional complejo';
  } else {
    mensajeEmociones.textContent = `Te sientes ${estadoEmocional}`;
    resultadoElement.textContent = 'Estado emocional simple';
  }
}

// Función para enviar las respuestas al servidor
function enviarRespuestas() {
  // Obtener las emociones del localStorage
  const emociones = obtenerEmociones();

  // Obtener el estado emocional
  const estadoEmocional = obtenerEstadoEmocional();

  // Enviar las respuestas al servidor
  const xhr = new XMLHttpRequest();
  xhr.open('POST', '/enviar-respuestas');
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.send(JSON.stringify({
    emociones,
    estadoEmocional
  }));

  // Mostrar un mensaje de confirmación
  const resultadoElement = document.getElementById('resultado');
  resultadoElement.textContent = 'Tus respuestas han sido enviadas correctamente.';

  // Redirigir a la página de resultados después de 2 segundos
  setTimeout(() => {
    window.location.href = 'resultados.html';
  }, 2000);

  return false;
}

// Agregar eventos a las preguntas
const preguntas = document.querySelectorAll('input[type="radio"]');
for (const pregunta of preguntas) {
  pregunta.addEventListener('change', () => {
    // Guardar las emociones seleccionadas en el localStorage
    const emocion = pregunta.getAttribute('data-emocion');
    let emociones = obtenerEmociones();
    if (pregunta.checked) {
      emociones.push(emocion);
    } else {
      emociones = emociones.filter(e => e !== emocion);
    }
    localStorage.setItem('emociones', JSON.stringify(emociones));

    // Mostrar el resultado
    mostrarResultado();
  });
}

// Mostrar el resultado inicial
mostrarResultado();
</script>


